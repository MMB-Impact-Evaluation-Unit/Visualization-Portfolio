---
title: "Bar plot state colors (accessible)"
author: "Katie Kotasek"
date: "2026-02-02"
editor_options: 
  chunk_output_type: console
---

```{r}
## LOAD PACKAGES ##
library(tidyverse)
library(mmbtools)

# accessibility package(s)
library(ggpattern)
library(colorBlindness)

mmb_load_fonts(quiet=TRUE)
```

```{r data}
category <- c("A","B","C","D","E","F")

n <- sample(1:100, length(category), replace = TRUE)

data <- data.frame(category,n)
```

```{r plot}
# Display bar chart
data %>%
    # order category/groups by count
    mutate(category = fct_reorder(category,-count)) %>%
    ggplot(aes(x=category,y=count,fill=category,pattern=category)) +
    # manually set patterns for the colors that don't meet the minimum contrast
    # ratio or look too similar while viewing different color vision deficiencies
    geom_col_pattern(
        position = "dodge"
        ,width=0.9
        ,color="black"    # adds black border around bars
        ,pattern_color = "white"   # sets color of the pattern
        ,pattern_angle = 45
        ,pattern_density = 0.05   # sets thickness of the pattern
        ,pattern_spacing = 0.04) +  # sets how close (or apart) the pattern is 
    scale_fill_mncol() +
    # set which category/groups have patterns
    scale_pattern_manual(
        values = c("A"="none","B"="none","C"="none","D"="circle","E"="stripe","F"="none")
    ) +
    labs(x="Category", y="Count") +
    theme_mmb_accessible(
        legend.position = "none"
    )
```

```{r}
# Save plot to PNG file
ggsave(
    filename = "Bar plot state colors (accessible).png",
    width=6.5, # Maximum plot width
    height=7 * 10/16, # Scale this however you want. Current is 16:10
    units="in"
)
```

