---
title: "Line plot state colors (accessible)"
author: "Katie Kotasek"
date: "2026-02-11"
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
## LOAD PACKAGES ##
library(tidyverse)
library(mmbtools)

# accessibility package(s)
library(colorBlindness)

mmb_load_fonts(quiet=TRUE)
```

```{r data}
data <- data.frame(
    Month = c("Jan", "Feb", "Mar")
    ,"A" = c(120, 130, 125)
    ,"B" = c(100, 105, 110)
    ,"C" = c(80, 82, 78)
    ,"D" = c(60, 65, 63)
    ,"E" = c(90, 95, 97)
    ,"F" = c(70, 75, 72)
) %>%
    pivot_longer(2:7, names_to = "Group",values_to = "value")

month_levels <- c("Jan","Feb","Mar")
```

```{r plot}
data %>%
    mutate(Month = factor(Month,levels = month_levels),label = Month) %>%
    ggplot(aes(x = Month, y = value, group = Group)) +
    geom_line(aes(color = Group,linetype=Group),linewidth = 1.8) +
    geom_point(aes(shape=Group,fill=Group),color = "black", stroke = 1.1, size = 4) +
    scale_y_continuous(expand = c(0.01, 0),limits=c(60,135),n.breaks=8) +
    scale_linetype_manual(values=c("A"=1,"B"=1,"C"=3,"D"=1,"E"=1,"F"=2)) +
    scale_shape_manual(values = c("A"=21,"B"=21,"C"=23,"D"=21,"E"=21,"F"=22)) +
    scale_color_manual(values=c(
        "A"="#003865","B"="#78BE21","C"="#5D295F",
        "D"="#008EAA","E"="#8D3F2B","F"="#0D5257")
    ) +
    scale_fill_manual(values=c(
        "A"="#003865","B"="#78BE21","C"="#5D295F",
        "D"="#008EAA","E"="#8D3F2B","F"="#0D5257")
    ) +
    # first point
    annotate("text",x=1,y=123,label="A",color="black",size=4,fontface = "bold") +
    annotate("text",x=1,y=103,label="B",color="black",size=4,fontface = "bold") +
    annotate("text",x=1,y=83,label="C",color="black",size=4,fontface = "bold") +
    annotate("text",x=1,y=63,label="D",color="black",size=4,fontface = "bold") +
    annotate("text",x=1,y=93,label="E",color="black",size=4,fontface = "bold") +
    annotate("text",x=1,y=73,label="F",color="black",size=4,fontface = "bold") +
    # last point
    annotate("text",x=3.1,y=126,label="A",color="black",size=4,fontface = "bold") +
    annotate("text",x=3.1,y=110,label="B",color="black",size=4,fontface = "bold") +
    annotate("text",x=3.1,y=79,label="C",color="black",size=4,fontface = "bold") +
    annotate("text",x=3.1,y=63,label="D",color="black",size=4,fontface = "bold") +
    annotate("text",x=3.1,y=98,label="E",color="black",size=4,fontface = "bold") +
    annotate("text",x=3.1,y=73,label="F",color="black",size=4,fontface = "bold") +
    labs(x="Month",y="Value") +
    theme_mmb_accessible(legend.position="none")


```

```{r}
# save to PNG
ggsave(
    filename = "Line plot state colors (accessible).png",
    width=6.5, # Maximum plot width should be 6.5 or 7
    height=7 * 10/16, # Scale this however you want. Current is 16:10
    units="in"
)
```

