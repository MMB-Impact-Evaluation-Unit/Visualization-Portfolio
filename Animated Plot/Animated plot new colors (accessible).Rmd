---
title: "Animated plot new colors (accessible)"
author: "Katie Kotasek"
date: "2026-02-18"
---

```{r packages, include=FALSE}
## LOAD PACKAGES ##
library(tidyverse)
library(mmbtools)
library(tidytuesdayR)

# plot specific packages
library(gganimate)
library(gifski)

# accessibility package
library(colorBlindness)

mmb_load_fonts(quiet=TRUE)
```

```{r data}
## READ TIDY TUESDAY DATA ##
tuesdata <- tt_load('2021-02-23')
earn <- tuesdata$earn

## FILTER DATA ##
earnFiltered <- earn %>%
    mutate(year = as.integer(year)) %>%
    filter(age %in% c("16 to 24 years","25 to 34 years","35 to 44 years","45 to 54 years", "55 to 64 years","65 years and over")) %>%
    filter(sex=="Both Sexes") %>%
    filter(race=="All Races") %>%
    filter(ethnic_origin=="All Origins") %>%
    filter(quarter==1) %>%
    select(c(4,5,7,8))

age_levels <- c("16 to 24 years",
    "25 to 34 years",
    "35 to 44 years",
    "45 to 54 years",
    "55 to 64 years",
    "65 years and over"
)
```

```{r static}
p <- earnFiltered %>%
    mutate(age = factor(age,levels = age_levels),label = as.character(age)) %>%
    ggplot(aes(x=n_persons,y=median_weekly_earn,color=age,fill=age)) +
    geom_point(size=5,shape=22,color="black",stroke=0.7) +
    # format y-axis labels
    scale_y_continuous(expand = c(0.007, 0),limits = c(0, 1250),labels=scales::dollar) +
    # shortened display text on x-axis to save space
    scale_x_continuous(labels=c("0","10,000","20,000","30,000")) +
    scale_color_manual("Age group",values=c("16 to 24 years"="#003865","25 to 34 years"="#78BE21","35 to 44 years"="#008EAA","45 to 54 years"="#A4BCC2","55 to 64 years"="#404788","65 years and over"="#FDEC51"),breaks = age_levels,limits = age_levels) +
    scale_fill_manual("Age group",values=c("16 to 24 years"="#003865","25 to 34 years"="#78BE21","35 to 44 years"="#008EAA","45 to 54 years"="#A4BCC2","55 to 64 years"="#404788","65 years and over"="#FDEC51"),breaks = age_levels,limits = age_levels) +
    labs(subtitle="Year: {frame_along}",x = "Number of persons (in thousands)",y = "Median weekly earnings") +
    theme_mmb_accessible(legend.position = "bottom")
```

```{r animate}
p_anim <- p + transition_reveal(year)
```

```{r}
animate(
    p_anim
    ,nframes = 80 # this controls transition speed (higher numbers slow down the speed)
    ,width = 650
    ,height = 425
)

## SAVE ANIMATION AS GIF ##
anim_save("Animated plot new colors (accessible).gif")
```

